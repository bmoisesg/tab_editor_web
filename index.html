<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>GF</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='main.css'>
    <script src='main.js'></script>
</head>

<body>
    <h1>test moises</h1>
    <button onclick="add_tab();">Agregar Pesta単a</button>
    <button onclick="metodo1();">Eliminar pesta単a</button>
    <button onclick="metodo2();">get data</button>
    <div id="pestanas">
        <ul id="lista_pestanas">
        </ul>
    </div>

    <body>
        <div id="contenidopestanas">
        </div>
    </body>
</body>

<script src="./js/index.js" type="text/javascript"></script>
<script src="./codemirror/jquery-1.7.2.min.js" type="text/javascript"></script>
<script src="./codemirror/lib/codemirror.js"></script>
<link rel="stylesheet" href="./codemirror/lib/codemirror.css">
<link rel="stylesheet" href="./css/index.css" type="text/css" />
<link rel="stylesheet" href="./js/dist/themes/default/style.min.css" />
<script src="./js/dist/jquery.min.js" type="text/javascript"></script>
<script src="./js/jstree.js" type="text/javascript"></script>
<script src="./js/dist/jstree.min.js" type="text/javascript"></script>


<script>

    var contador = 0;
    var lista = new Array();
    var vent_focus = "pestana1";

    function linkedlist(pestana, nombre) {
        var obj = new Object();
        obj.pestana = pestana;
        obj.nombre = nombre;
        lista.push(obj);
    }
    function metodo1() {
        //alert("dato: "+contador+ " focus: " +vent_focus+" : "+vent_focus.replace("textarea",""))
        
        $('body #pestana'+vent_focus.replace("textarea","")).remove();
        index("pestanas", "pestana0");
    }
    function metodo2() {
        
        var data = document.getElementById(get_vent());
        
        alert(data.value)

    }

    function get_vent() {
        return vent_focus;
    }

    function set_vent(vent) {
        vent_focus = vent;
    }

    function get_cont() {
        return contador++;
    }

    function index(pestanias, pestania) {
        var id = pestania.replace('pestana', '');
        set_vent('textarea' + id);

        var pestanna1 = document.getElementById(pestania);
        var listaPestannas = document.getElementById(pestanias);
        var cpestanna = document.getElementById('c' + pestania);
        var listacPestannas = document.getElementById('contenido' + pestanias);

        var i = 0;
        while (typeof listacPestannas.getElementsByTagName('div')[i] != 'undefined') {
            $(document).ready(function () {
                $(listacPestannas.getElementsByTagName('div')[i]).css('display', 'none');
                $(listaPestannas.getElementsByTagName('li')[i]).css('background', '');
                $(listaPestannas.getElementsByTagName('li')[i]).css('padding-bottom', '');
            });
            i += 1;
        }

        $(document).ready(function () {
            $(cpestanna).css('display', '');
            $(pestanna1).css('background', 'dimgray');
            $(pestanna1).css('padding-bottom', '2px');
        });

        try {
            var act = document.getElementById('cpestana' + id);
            var tact = document.getElementById('textarea' + id);

            while (act.firstChild) {
                act.removeChild(act.firstChild);
            }

            act.appendChild(tact);
            var editor = CodeMirror(act, {
                lineNumbers: true,
                value: tact.value,
                matchBrackets: true,
                styleActiveLine: true,
                theme: "eclipse",
                mode: "text/x-java"
            }).on('change', editor => {
                tact.value = editor.getValue();
            });
        } catch (error) { }
    }

    function add_tab() {
        console.log("texto metodo add_tab----------------------")
        var x = get_cont();
        var lista_pesta単as = document.getElementById("lista_pestanas");
        var li = document.createElement("li");
        li.setAttribute('id', 'pestana' + x);
        var a = document.createElement("a");
        a.setAttribute('id', 'a' + x);
        a.setAttribute('href', 'javascript:index("pestanas","pestana' + x + '")');
        a.text = 'pestana' + x;
        li.appendChild(a);
        lista_pesta単as.appendChild(li);
        index("pestanas", "pestana" + x);

        var contenido = document.getElementById("contenidopestanas");
        var divp = document.createElement("div");
        divp.setAttribute('id', 'cpestana' + x);
        var ta = document.createElement("textarea");
        ta.setAttribute('id', 'textarea' + x);
        ta.setAttribute('name', 'textarea' + x);
        ta.setAttribute('class', 'ta');
        ta.setAttribute('style', 'display:none');
        ta.cols = 123;
        ta.rows = 30;
        divp.appendChild(ta);
        contenido.appendChild(divp);

        var act = document.getElementById('cpestana' + x);
        var tact = document.getElementById('textarea' + x);
        var editor = CodeMirror(act, {
            lineNumbers: true,
            value: tact.value,
            matchBrackets: true,
            styleActiveLine: true,
            theme: "eclipse",
            mode: "text/x-java"
        }).on('change', editor => {
            tact.value = editor.getValue();
        });
    }

</script>

</html>